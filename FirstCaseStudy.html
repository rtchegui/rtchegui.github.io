<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Roger Tchegui &amp; Shiju Raju" />


<title>First Case Study</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">MyPage</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="aboutme.html">Home</a>
</li>
<li>
  <a href="index.html">other</a>
</li>
<li>
  <a href="FirstCaseStudy.html">case study 1</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">First Case Study</h1>
<h4 class="author">Roger Tchegui &amp; Shiju Raju</h4>
<h4 class="date">6/25/2021</h4>

</div>


<pre class="r"><code>library(stringr)</code></pre>
<pre><code>## Warning: package &#39;stringr&#39; was built under R version 4.0.5</code></pre>
<pre class="r"><code>library(dplyr)</code></pre>
<pre><code>## Warning: package &#39;dplyr&#39; was built under R version 4.0.5</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code>library(ggplot2)</code></pre>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.0.5</code></pre>
<pre class="r"><code>library(tidyr)</code></pre>
<pre><code>## Warning: package &#39;tidyr&#39; was built under R version 4.0.5</code></pre>
<pre class="r"><code>library(gridExtra)</code></pre>
<pre><code>## Warning: package &#39;gridExtra&#39; was built under R version 4.0.5</code></pre>
<pre><code>## 
## Attaching package: &#39;gridExtra&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     combine</code></pre>
<pre class="r"><code>library(knitr)</code></pre>
<pre><code>## Warning: package &#39;knitr&#39; was built under R version 4.0.5</code></pre>
<pre class="r"><code>library(class)</code></pre>
<pre><code>## Warning: package &#39;class&#39; was built under R version 4.0.5</code></pre>
<pre class="r"><code>library(caret)</code></pre>
<pre><code>## Warning: package &#39;caret&#39; was built under R version 4.0.5</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre class="r"><code>library(e1071)</code></pre>
<pre><code>## Warning: package &#39;e1071&#39; was built under R version 4.0.5</code></pre>
<div id="r-markdown" class="section level2">
<h2>R Markdown</h2>
<p>This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <a href="http://rmarkdown.rstudio.com" class="uri">http://rmarkdown.rstudio.com</a>.</p>
<p>When you click the <strong>Knit</strong> button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:</p>
<pre class="r"><code>## Reading Beers dataset 
beers &lt;- read.csv(&#39;Beers.csv&#39;, header = TRUE)

## Displaying top 5 rows from Beer datatset
head(beers,5)</code></pre>
<pre><code>##                  Name Beer_ID   ABV IBU Brewery_id                          Style Ounces
## 1            Pub Beer    1436 0.050  NA        409            American Pale Lager     12
## 2         Devil&#39;s Cup    2265 0.066  NA        178        American Pale Ale (APA)     12
## 3 Rise of the Phoenix    2264 0.071  NA        178                   American IPA     12
## 4            Sinister    2263 0.090  NA        178 American Double / Imperial IPA     12
## 5       Sex and Candy    2262 0.075  NA        178                   American IPA     12</code></pre>
<pre class="r"><code>## Reading the breweries dataset
breweries &lt;- read.csv(&#39;Breweries.csv&#39;,header = TRUE)

## Displaying top 5 rows from Breweries dataset
head(breweries,5)</code></pre>
<pre><code>##   Brew_ID                      Name          City State
## 1       1        NorthGate Brewing    Minneapolis    MN
## 2       2 Against the Grain Brewery    Louisville    KY
## 3       3  Jack&#39;s Abby Craft Lagers    Framingham    MA
## 4       4 Mike Hess Brewing Company     San Diego    CA
## 5       5   Fort Point Beer Company San Francisco    CA</code></pre>
</div>
<div id="how-many-breweries-are-present-in-each-state" class="section level2">
<h2>1) How many breweries are present in each state?</h2>
<pre class="r"><code>breweries$State &lt;- str_replace_all(breweries$State,&quot;[&#39; &#39;]&quot;,&#39;&#39;)  ## Removing quotation on the States name. 

#breweries %&gt;% group_by(State) %&gt;% summarise(count = n()) 

state_df &lt;- data.frame(&#39;abb&#39;=state.abb,&#39;State_Name&#39;=state.name)  ##  Spelling out States name not just abbreviation

breweries_merge &lt;- merge(breweries,state_df, by.x =&#39;State&#39;, by.y = &#39;abb&#39;, all.x=T)

breweries_merge$State_Name[which(breweries$State==&#39;DC&#39;)] &lt;- &#39;District of Columbia&#39; ## Mapping DC state to the NA value 

## Graphical representation of breweries on each states

breweries_merge %&gt;% filter(!is.na(State_Name))%&gt;% group_by(State_Name) %&gt;% mutate(count = n()) %&gt;% ggplot(aes(x=State_Name, fill=State_Name),stat=&#39;count&#39;)+
  geom_bar()+ geom_text(aes(label=after_stat(count)), stat=&#39;count&#39;,nudge_y=1.8,va=&#39;bottom&#39;)+ggtitle(&#39;Number of Breweries by state&#39;)+ xlab(&#39;State&#39;)+ylab(&#39;Number of Breweries&#39;) + theme(legend.position = &quot;none&quot;,axis.text.y = element_text(size=8)) +  coord_flip()</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: va</code></pre>
<p><img src="FirstCaseStudy_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="conclusion-colorado-is-the-state-with-the-most-breweries." class="section level2">
<h2>Conclusion: Colorado is the State with the most Breweries.</h2>
</div>
<div id="merge-beer-data-with-the-breweries-data.-print-the-first-6" class="section level2">
<h2>2) Merge beer data with the breweries data. Print the first 6</h2>
<pre><code>observations and the last six observations to check the merged file.  </code></pre>
<p>(RMD only, this does not need to be included in the presentation or the deck.)</p>
<pre class="r"><code># Merge beer dataset with Breweries dataset based on the unique ID
BB_merge &lt;- merge(x = beers,y = breweries_merge,by.y = &quot;Brew_ID&quot;,by.x = &#39;Brewery_id&#39;, all.x = TRUE)

# Showing first six observations
head(BB_merge,6)</code></pre>
<pre><code>##   Brewery_id        Name.x Beer_ID   ABV IBU                               Style Ounces State             Name.y        City
## 1          1  Get Together    2692 0.045  50                        American IPA     16    MN NorthGate Brewing  Minneapolis
## 2          1 Maggie&#39;s Leap    2691 0.049  26                  Milk / Sweet Stout     16    MN NorthGate Brewing  Minneapolis
## 3          1    Wall&#39;s End    2690 0.048  19                   English Brown Ale     16    MN NorthGate Brewing  Minneapolis
## 4          1       Pumpion    2689 0.060  38                         Pumpkin Ale     16    MN NorthGate Brewing  Minneapolis
## 5          1    Stronghold    2688 0.060  25                     American Porter     16    MN NorthGate Brewing  Minneapolis
## 6          1   Parapet ESB    2687 0.056  47 Extra Special / Strong Bitter (ESB)     16    MN NorthGate Brewing  Minneapolis
##   State_Name
## 1  Minnesota
## 2  Minnesota
## 3  Minnesota
## 4  Minnesota
## 5  Minnesota
## 6  Minnesota</code></pre>
<pre class="r"><code># showing last six observations
tail(BB_merge,6)</code></pre>
<pre><code>##      Brewery_id                    Name.x Beer_ID   ABV IBU                   Style Ounces State                        Name.y
## 2405        556             Pilsner Ukiah      98 0.055  NA         German Pilsener     12    CA         Ukiah Brewing Company
## 2406        557  Heinnieweisse Weissebier      52 0.049  NA              Hefeweizen     12    NY       Butternuts Beer and Ale
## 2407        557           Snapperhead IPA      51 0.068  NA            American IPA     12    NY       Butternuts Beer and Ale
## 2408        557         Moo Thunder Stout      50 0.049  NA      Milk / Sweet Stout     12    NY       Butternuts Beer and Ale
## 2409        557         Porkslap Pale Ale      49 0.043  NA American Pale Ale (APA)     12    NY       Butternuts Beer and Ale
## 2410        558 Urban Wilderness Pale Ale      30 0.049  NA        English Pale Ale     12    AK Sleeping Lady Brewing Company
##               City State_Name
## 2405         Ukiah California
## 2406 Garrattsville   New York
## 2407 Garrattsville   New York
## 2408 Garrattsville   New York
## 2409 Garrattsville   New York
## 2410     Anchorage     Alaska</code></pre>
</div>
<div id="conclusion-the-first-6-and-last-6-observation-show-a-heavy-concentration-of-breweries-in-the-state-of-new-york" class="section level1">
<h1>Conclusion: The first 6 and last 6 observation show a heavy concentration of breweries in the state of New-York</h1>
<div id="address-the-missing-values-in-each-column" class="section level2">
<h2>3) Address the missing values in each column</h2>
<pre class="r"><code>missing.values &lt;- BB_merge %&gt;% as.data.frame %&gt;%
  gather(key = &quot;key&quot;, value = &quot;val&quot;) %&gt;%
  mutate(is.missing = is.na(val)) %&gt;%
  group_by(key, is.missing) %&gt;%
  summarise(num.missing = n()) %&gt;%
  filter(is.missing==T) %&gt;%
  select(-is.missing) %&gt;%
  arrange(desc(num.missing)) </code></pre>
<pre><code>## `summarise()` has grouped output by &#39;key&#39;. You can override using the `.groups` argument.</code></pre>
<pre class="r"><code>missing.values  %&gt;% kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">key</th>
<th align="right">num.missing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">IBU</td>
<td align="right">1005</td>
</tr>
<tr class="even">
<td align="left">ABV</td>
<td align="right">62</td>
</tr>
<tr class="odd">
<td align="left">State_Name</td>
<td align="right">8</td>
</tr>
</tbody>
</table>
<pre class="r"><code>## Graphical representation of the missing values on ABV &amp; IBU 

missing.values %&gt;% ggplot(aes(x=key, y=num.missing, fill = key,group=num.missing))+
  geom_bar(stat=&#39;identity&#39;,position = &#39;dodge&#39;)+geom_text(aes(label=num.missing),position = position_dodge(width = 2))+
  ggtitle(&#39;Missing Values on ABV &amp; IBU&#39;)+xlab(&#39;Fields&#39;) +ylab(&#39;Missing Values&#39;) + theme(legend.position = &quot;none&quot;) + coord_flip()</code></pre>
<pre><code>## Warning: position_dodge requires non-overlapping x intervals</code></pre>
<p><img src="FirstCaseStudy_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="conclusion-the-sorting-and-graphing-of-missing-values-show-that-we-have-a-lots-of-ibu-missing-values" class="section level2">
<h2>Conclusion: The sorting and graphing of missing values show that we have a lots of IBU missing values</h2>
</div>
<div id="compute-the-median-alcohol-content-and-international-bitterness-unit-for-each-state.-plot-a-bar-chart-to-compare." class="section level2">
<h2>4.) Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.</h2>
<pre class="r"><code>## Compute and plot the median alcohol content by each state.

BB_merge_final &lt;- BB_merge %&gt;% group_by(State) %&gt;% mutate(median_ABV = median(ABV,na.rm = TRUE))

## Plot a bar chart for median ABV.

BB_merge %&gt;%filter(!is.na(State_Name)) %&gt;%group_by(State_Name) %&gt;% summarise(median_ABV = median(ABV, na.rm= T)) %&gt;% ggplot(aes(x=State_Name, y= median_ABV, fill = State_Name)) +geom_bar(stat = &quot;Summary&quot;, position = &quot;dodge&quot;) + geom_text(aes(label = median_ABV), nudge_y = 0.004)+ ggtitle(&quot;Alcohol  Content&quot;) + xlab(&#39;State&#39;)+ ylab(&#39;mediane&#39;) + theme(legend.position = &quot;none&quot;, axis.text.y = element_text(size=8)) + coord_flip()  </code></pre>
<pre><code>## No summary function supplied, defaulting to `mean_se()`</code></pre>
<p><img src="FirstCaseStudy_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code>##  Compute and plot the median international bitterness unit by each state.
BB_merge_final &lt;- BB_merge_final %&gt;% group_by(State) %&gt;% mutate(median_IBU = median(IBU,na.rm = TRUE))

## Plot a bar chart for median IBU.
BB_merge %&gt;% filter(!is.na(State_Name)) %&gt;% group_by(State_Name) %&gt;% summarise(median_IBU = median(IBU, na.rm= T)) %&gt;% ggplot(aes(x=State_Name, y= median_IBU, fill = State_Name)) +
  geom_bar(stat = &quot;Summary&quot;, position = &quot;dodge&quot;) + geom_text(aes(label = median_IBU), nudge_y =  0.004)+ ggtitle(&quot;International Bitterness&quot;) + xlab(&#39;State&#39;)+ ylab(&#39;mediane&#39;)  + theme(legend.position = &quot;none&quot;, axis.text.y = element_text(size=8)) + coord_flip()</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_summary).</code></pre>
<pre><code>## No summary function supplied, defaulting to `mean_se()`</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_text).</code></pre>
<p><img src="FirstCaseStudy_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div id="conclusion-the-graphing-representation-of-median-abv-show-few-states-with-a-pretty-high-alcohol-content-west-virginia-new-mexico-michigan-kentucky-and-dc-while-west-virginia-and-maine-have-the-more-bitter-beer." class="section level4">
<h4>Conclusion: The graphing representation of median ABV show few states with a pretty high Alcohol content (West Virginia, New-Mexico, Michigan, Kentucky and DC), while West Virginia, and Maine have the more Bitter beer.</h4>
</div>
</div>
<div id="which-state-has-the-maximum-alcoholic-abv-beer-which-state-has-the-most-bitter-ibu-beer" class="section level2">
<h2>5) Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?</h2>
<pre class="r"><code>BB_merge$State_Name[which.max(BB_merge$ABV)]</code></pre>
<pre><code>## [1] &quot;Colorado&quot;</code></pre>
<pre class="r"><code>BB_merge$State_Name[which.max(BB_merge$IBU)]</code></pre>
<pre><code>## [1] &quot;Oregon&quot;</code></pre>
<pre class="r"><code>BB_merge %&gt;% filter(!is.na(State_Name))%&gt;%  group_by(State_Name) %&gt;% summarise(max_ABV = max(ABV, na.rm = T)) %&gt;% ggplot(aes(x= max_ABV , y = State_Name, fill=State_Name)) + 
   geom_bar(position=&#39;dodge&#39;,stat = &#39;summary&#39;) + geom_text(aes(label = max_ABV), nudge_x =  0.01) + theme(legend.position = &quot;none&quot;, axis.text.y = element_text(size=8))</code></pre>
<pre><code>## No summary function supplied, defaulting to `mean_se()`</code></pre>
<p><img src="FirstCaseStudy_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<pre class="r"><code>BB_merge %&gt;% filter(!is.na(State_Name)) %&gt;% group_by(State_Name) %&gt;% summarise(max_IBU = max(IBU, na.rm = T)) %&gt;% ggplot(aes(x= max_IBU , y = State_Name, fill=State_Name)) + 
  geom_bar(position=&#39;dodge&#39;,stat = &#39;summary&#39;) + geom_text(aes(label = max_IBU), nudge_x =  0.01) + theme(legend.position = &quot;none&quot;, axis.text.y = element_text(size=8))</code></pre>
<pre><code>## Warning in max(IBU, na.rm = T): no non-missing arguments to max; returning -Inf</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_summary).</code></pre>
<pre><code>## No summary function supplied, defaulting to `mean_se()`</code></pre>
<p><img src="FirstCaseStudy_files/figure-html/unnamed-chunk-13-2.png" width="672" /></p>
</div>
<div id="conclusion-colorado-and-oregon-have-the-maximum-alcoholic-content-and-the-most-bitter-beer" class="section level2">
<h2>Conclusion: Colorado and Oregon have the maximum alcoholic content and the most bitter beer</h2>
</div>
<div id="comment-on-the-summary-statistics-and-distribution-of-the-abv-variable." class="section level2">
<h2>6) Comment on the summary statistics and distribution of the ABV variable.</h2>
<pre class="r"><code>summary(BB_merge$ABV)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
## 0.00100 0.05000 0.05600 0.05977 0.06700 0.12800      62</code></pre>
<pre class="r"><code>BB_merge %&gt;% ggplot(aes(x=ABV)) + geom_histogram()</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 62 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="FirstCaseStudy_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code>BB_merge %&gt;% ggplot(aes(sample = ABV)) + stat_qq()+stat_qq_line()</code></pre>
<pre><code>## Warning: Removed 62 rows containing non-finite values (stat_qq).</code></pre>
<pre><code>## Warning: Removed 62 rows containing non-finite values (stat_qq_line).</code></pre>
<p><img src="FirstCaseStudy_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
</div>
<div id="conclusion-the-above-statistic-and-distribution-of-the-abv-variable-show-a-normally-distributed-data-with-a-linear-correlation" class="section level2">
<h2>Conclusion: The above statistic and distribution of the ABV variable show a normally distributed data with a linear correlation</h2>
</div>
<div id="is-there-an-apparent-relationship-between-the-bitterness-of-the-beer-and-its-alcoholic-content-draw-a-scatter-plot.make-your-best-judgment-of-a-relationship-and-explain-your-answer." class="section level2">
<h2>7) Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot.Make your best judgment of a relationship and EXPLAIN your answer.</h2>
<pre class="r"><code>BB_merge$scaledIBU &lt;- scale(BB_merge$IBU)
BB_merge$scaledABV &lt;- scale(BB_merge$ABV)
coef(lm(scaledIBU ~ scaledABV, data = BB_merge))</code></pre>
<pre><code>## (Intercept)   scaledABV 
## -0.00693796  0.66891271</code></pre>
<pre class="r"><code>BB_merge %&gt;% ggplot(aes(y=scaledABV, x=scaledIBU)) + geom_point(color=&#39;blue&#39;) + geom_smooth(method = &#39;lm&#39;,se=TRUE, color = &quot;Red&quot;) #+geom_abline(intercept = -2.959529, slope=49.39)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 1005 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 1005 rows containing missing values (geom_point).</code></pre>
<p><img src="FirstCaseStudy_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="conclusion-the-scatter-plot-draw-above-show-an-apparent-relationship-between-bitterness-of-the-beer-and-its-alcoholic-content." class="section level2">
<h2>Conclusion: The scatter plot draw above show an apparent relationship between bitterness of the beer and its alcoholic content.</h2>
</div>
<div id="budweiser-would-also-like-to-investigate-the-difference-with-respect-to-ibu-and-abv-between-ipas-india-pale-ales-and-other-types-of-ale-any-beer-with-ale-in-its-name-other-than-ipa.-you-decide-to-use-knn-classification-to-investigate-this-relationship.-provide-statistical-evidence-one-way-or-the-other.-you-can-of-course-assume-your-audience-is-comfortable-with-percentages-knn-is-very-easy-to-understand-conceptually." class="section level2">
<h2>8) Budweiser would also like to investigate the difference with respect to IBU and ABV between IPAs (India Pale Ales) and other types of Ale (any beer with “Ale” in its name other than IPA). You decide to use KNN classification to investigate this relationship. Provide statistical evidence one way or the other. You can of course assume your audience is comfortable with percentages … KNN is very easy to understand conceptually.</h2>
</div>
<div id="in-addition-while-you-have-decided-to-use-knn-to-investigate-this-relationship-knn-is-required-you-may-also-feel-free-to-supplement-your-response-to-this-question-with-any-other-methods-or-techniques-you-have-learned.-creativity-and-alternative-solutions-are-always-encouraged." class="section level2">
<h2>In addition, while you have decided to use KNN to investigate this relationship (KNN is required) you may also feel free to supplement your response to this question with any other methods or techniques you have learned. Creativity and alternative solutions are always encouraged.</h2>
<pre class="r"><code>#Filtering out IPA and Ale

BB_merge_mutate &lt;- BB_merge %&gt;% mutate(target_var = ifelse(str_detect(Style,regex(&quot; Ale&quot;,ignore_case = T)),&quot;Ale&quot;, ifelse(str_detect(Style,regex(&quot; IPA&quot;, ignore_case = T)),&quot;IPA&quot;,&#39;NA&#39;)))
BB_merge_filtered &lt;- BB_merge_mutate %&gt;% filter(target_var != &quot;NA&quot;)

BB_merge_filtered &lt;- BB_merge_filtered %&gt;% filter(!is.na(ABV) &amp; !is.na(IBU))

BB_merge_filtered %&gt;% ggplot(aes(x=IBU, y=ABV, color=target_var)) + geom_point()</code></pre>
<p><img src="FirstCaseStudy_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<pre class="r"><code>BB_merge_filtered %&gt;% filter(is.na(ABV))</code></pre>
<pre><code>##  [1] Brewery_id Name.x     Beer_ID    ABV        IBU        Style      Ounces     State      Name.y     City       State_Name
## [12] scaledIBU  scaledABV  target_var
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<pre class="r"><code>BB_merge_filtered$scaleABV &lt;- scale(BB_merge_filtered$ABV)
BB_merge_filtered$scaleIBU &lt;- scale(BB_merge_filtered$IBU)


IPA &lt;- BB_merge_final[str_detect(BB_merge_final$Style, &quot;IPA&quot;), ]
Ale &lt;- BB_merge_final[str_detect(BB_merge_final$Style, &quot;Ale&quot;), ]

#replace entire name in style with &quot;IPA&quot;

replace_IPA&lt;-IPA %&gt;% mutate(Style = paste0( ifelse(grepl(&quot;IPA&quot;, Style), &quot;IPA&quot;, &#39;&#39;)))
#replace entire name in styler with &quot;Ale&quot;
replace_Ale&lt;-Ale %&gt;% mutate(Style = paste0( ifelse(grepl(&quot;Ale&quot;, Style), &quot;Ale&quot;, &#39;&#39;)))
total&lt;-rbind(replace_IPA,replace_Ale)
head(total)</code></pre>
<pre><code>## # A tibble: 6 x 13
## # Groups:   State [3]
##   Brewery_id Name.x       Beer_ID   ABV   IBU Style Ounces State Name.y               City     State_Name median_ABV median_IBU
##        &lt;int&gt; &lt;chr&gt;          &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;                &lt;chr&gt;    &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;
## 1          1 Get Together    2692 0.045    50 IPA       16 MN    &quot;NorthGate Brewing &quot; Minneap~ Minnesota      0.056        44.5
## 2          2 Citra Ass D~    2686 0.08     68 IPA       16 KY    &quot;Against the Grain ~ Louisvi~ Kentucky       0.0625       31.5
## 3          2 Rico Sauvin     2678 0.076    68 IPA       16 KY    &quot;Against the Grain ~ Louisvi~ Kentucky       0.0625       31.5
## 4          2 Pile of Face    2675 0.06     65 IPA       16 KY    &quot;Against the Grain ~ Louisvi~ Kentucky       0.0625       31.5
## 5          4 Habitus (20~    2668 0.08    100 IPA       16 CA    &quot;Mike Hess Brewing ~ San Die~ California     0.058        42  
## 6          4 Solis           2667 0.075    85 IPA       16 CA    &quot;Mike Hess Brewing ~ San Die~ California     0.058        42</code></pre>
<pre class="r"><code>#geom_smooth(method = &quot;lm&quot;)+
total%&gt;% ggplot(aes(x = median_IBU, y = median_ABV, color=Style)) + geom_point() +
  ggtitle(&quot;Alcohol Content vs. Bitterness&quot;) +   
  xlab(&quot;Bitterness(IBU)&quot;) + ylab(&quot;Alcohol by volume(ABV)&quot;)</code></pre>
<pre><code>## Warning: Removed 5 rows containing missing values (geom_point).</code></pre>
<p><img src="FirstCaseStudy_files/figure-html/unnamed-chunk-19-2.png" width="672" /></p>
<pre class="r"><code>replace_IPA%&gt;% ggplot(aes(x = median_IBU, y = median_ABV, color=Style)) + geom_point() +
  geom_smooth(method = &quot;lm&quot;)+ 
  ggtitle(&quot;IPA Alcohol Content vs. Bitterness&quot;) +   
  xlab(&quot;Bitterness(IBU)&quot;) + ylab(&quot;Alcohol by volume(ABV)&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="FirstCaseStudy_files/figure-html/unnamed-chunk-19-3.png" width="672" /></p>
<pre class="r"><code>replace_Ale%&gt;% ggplot(aes(x = median_IBU, y = median_ABV, color=Style)) + geom_point() +
  geom_smooth(method = &quot;lm&quot;)+ 
  ggtitle(&quot;Ale-Alcohol Content vs. Bitterness&quot;) +   
  xlab(&quot;Bitterness(IBU)&quot;) + ylab(&quot;Alcohol by volume(ABV)&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
<p><img src="FirstCaseStudy_files/figure-html/unnamed-chunk-19-4.png" width="672" /></p>
<pre class="r"><code>set.seed(6)
splitPerc = .70

total=na.omit(total)#Omit rows with NAs.
trainIndices = sample(1:dim(total)[1],round(splitPerc * dim(total)[1]))
train = total[trainIndices,]
test = total[-trainIndices,]

## Loop for many k and one training / test partition
accs = data.frame(accuracy = numeric(90), k = numeric(90))
for(i in 1:90)
{
  classifications = knn(train[,c(4,5)],test[,c(4,5)],train$Style, prob = TRUE, k = i)
  table(test$Style,classifications)
  CM = confusionMatrix(table(test$Style,classifications))
  accs$accuracy[i] = CM$overall[1]
  accs$k[i] = i
}
plot(accs$k,accs$accuracy, type = &quot;l&quot;, xlab = &quot;k&quot;)</code></pre>
<p><img src="FirstCaseStudy_files/figure-html/unnamed-chunk-19-5.png" width="672" /></p>
<pre class="r"><code>#CM
classifications = knn(train[,c(4,5)],test[,c(4,5)],train$Style, prob = TRUE, k = 35)
table(classifications,test$Style)</code></pre>
<pre><code>##                
## classifications Ale IPA
##             Ale 154  25
##             IPA  17  88</code></pre>
<pre class="r"><code>confusionMatrix(table(classifications,test$Style))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##                
## classifications Ale IPA
##             Ale 154  25
##             IPA  17  88
##                                           
##                Accuracy : 0.8521          
##                  95% CI : (0.8054, 0.8913)
##     No Information Rate : 0.6021          
##     P-Value [Acc &gt; NIR] : &lt;2e-16          
##                                           
##                   Kappa : 0.6876          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.2801          
##                                           
##             Sensitivity : 0.9006          
##             Specificity : 0.7788          
##          Pos Pred Value : 0.8603          
##          Neg Pred Value : 0.8381          
##              Prevalence : 0.6021          
##          Detection Rate : 0.5423          
##    Detection Prevalence : 0.6303          
##       Balanced Accuracy : 0.8397          
##                                           
##        &#39;Positive&#39; Class : Ale             
## </code></pre>
</div>
<div id="conclusion-the-above-analysis-show-a-lot-more-of-ibu-beers-of-types-ipa-compare-to-type-ale" class="section level2">
<h2>Conclusion: The above analysis show a lot more of IBU beers of types IPA compare to type Ale</h2>
</div>
<div id="knock-their-socks-off-find-one-other-useful-inference-from-the-data-that-you-feel-budweiser-may-be-able-to-find-value-in.-you-must-convince-them-why-it-is-important-and-back-up-your-conviction-with-appropriate-statistical-evidence." class="section level2">
<h2>9) Knock their socks off! Find one other useful inference from the data that you feel Budweiser may be able to find value in. You must convince them why it is important and back up your conviction with appropriate statistical evidence.</h2>
<pre class="r"><code>#Which style of beer occurs most?

Lager &lt;- BB_merge_final[str_detect(BB_merge_final$Style, &quot;Lager&quot;), ]
Porter &lt;- BB_merge_final[str_detect(BB_merge_final$Style, &quot;Porter&quot;), ]
Stout &lt;- BB_merge_final[str_detect(BB_merge_final$Style, &quot;Stout&quot;), ]
Bock &lt;- BB_merge_final[str_detect(BB_merge_final$Style, &quot;Bock&quot;), ]
Cider &lt;- BB_merge_final[str_detect(BB_merge_final$Style, &quot;Cider&quot;), ]
Pilsner &lt;- BB_merge_final[str_detect(BB_merge_final$Style, &quot;Pilsner&quot;), ]

replace_Lager&lt;-Lager %&gt;% mutate(Style = paste0( ifelse(grepl(&quot;Lager&quot;, Style), &quot;Lager&quot;, &#39;&#39;)))
replace_Porter&lt;-Porter %&gt;% mutate(Style = paste0( ifelse(grepl(&quot;Porter&quot;, Style), &quot;Porter&quot;, &#39;&#39;)))
replace_Stout&lt;-Stout %&gt;% mutate(Style = paste0( ifelse(grepl(&quot;Stout&quot;, Style), &quot;Stout&quot;, &#39;&#39;)))
replace_Bock&lt;-Bock %&gt;% mutate(Style = paste0( ifelse(grepl(&quot;Bock&quot;, Style), &quot;Bock&quot;, &#39;&#39;)))
replace_Cider&lt;-Cider %&gt;% mutate(Style = paste0( ifelse(grepl(&quot;Cider&quot;, Style), &quot;Cider&quot;, &#39;&#39;)))
replace_Pilsner&lt;-Pilsner %&gt;% mutate(Style = paste0( ifelse(grepl(&quot;Pilsner&quot;, Style), &quot;Pilsner&quot;, &#39;&#39;)))

other&lt;-rbind(replace_IPA,replace_Ale,replace_Lager,replace_Porter,replace_Stout,replace_Bock,replace_Cider,replace_Pilsner)

other %&gt;% ggplot(aes(x=Style, fill=Style),stat=&#39;count&#39;)+
    geom_bar()+
    ggtitle(&#39;Different Style of Beer&#39;)+ 
    xlab(&#39;Beer Style&#39;)+ylab(&#39;Count&#39;)</code></pre>
<p><img src="FirstCaseStudy_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="conclusion-the-above-finding-show-that-whith-a-big-concentration-of-ale-type-of-beers-follow-by-the-ipa-type-of-beers" class="section level2">
<h2>Conclusion: The above finding show that whith a big concentration of ALE type of beers follow by the IPA type of beers</h2>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
